## Game > Gamebase > Upgrade Guide

## 2.21.2

### iOS

* Gamebase iOS SDK 2.21.1 에서 bitcode 를 활성화 한 후에 **아카이브 빌드**를 하면 에러가 발생합니다.
    * bitcode 사용을 원하시는 경우엔 위 이슈가 해결된 Gamebase iOS SDK 2.21.2 를 사용하시기 바랍니다.

## 2.21.0

### Android

* Gamebase Android SDK 2.21.0 은 jCenter 에는 잘못된 빌드가 배포되어, **jcenter()** 를 **mavenCentral()** 보다 먼저 선언 했다면 모든 Gamebase API 에서 크래시가 발생할 수 있습니다.
    * 정상적으로 배포된 Gamebase Android SDK 2.21.1 을 사용하시거나 **mavenCentral()** 을 **jcenter()** 보다 먼저 선언하시기 바랍니다.
* Maven Repository
    * jCenter 가 일반 사용자를 위한 서비스를 종료하여 ( [https://jfrog.com/blog/into-the-sunset-bintray-jcenter-gocenter-and-chartcenter/](https://jfrog.com/blog/into-the-sunset-bintray-jcenter-gocenter-and-chartcenter/) ) 더 이상 새로운 빌드는 업로드는 할 수 없게 되었습니다.(jCenter 의 접근 또한 2022 년 2월 1일에 종료됩니다.)
    * 그래서 Gamebase Android SDK 2.21.0 부터는 **jcenter()** 가 아닌 **mavenCentral()** 에서만 배포가 되므로 gradle repository 에 mavenCentral 을 추가하세요.

```groovy
repositories {
    // >>> For Gamebase SDK
    mavenCentral()
    ...
}
```

#### Line IdP

* Line IdP 를 사용하는 경우, Line SDK 업데이트로 인해 아래와 같이 Gradle 에 **JavaVersion.VERSION_1_8** 설정을 하지 않으면 빌드가 실패합니다.
* Line IdP 를 사용하는 경우, Line SDK 내부에 **android:allowBackup="false"** 로 선언되어 있어 어플리케이션 빌드시 Manifest merger 에서 fail 이 발생할 수 있습니다. 이렇게 빌드가 실패한다면 다음과 같이 application 태그에 **tools:replace="android:allowBackup"** 선언을 추가하시기 바랍니다.

```groovy
android {
    compileOptions {
        // >>> [Line IdP]
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
    
}
```

```xml
<application
      tools:replace="android:allowBackup"
      ... >
```

### iOS

* Gamebase iOS SDK 2.21.0 에서 bitcode 를 사용할 경우 에러가 발생합니다.
    * bitcode 사용을 원하시는 경우엔 Gamebase iOS SDK 2.21.1 을 사용하시기 바랍니다.

## 2.20.2

### iOS

#### Facebook IdP

* Gamebase iOS SDK 2.20.2でFacebook SDKが9.1.0にアップデートされました。 
    * Facebook SDKに追加設定が必要なため、info.plistに以下の値を追加してください。設定しない場合はクラッシュが発生する場合がります。
        * FacebookAutoLogAppEventsEnabled
        * FacebookAdvertiserIDCollectionEnabled
* 詳細な内容は[Facebook iOS SDKガイド](https://developers.facebook.com/docs/app-events/getting-started-app-events-ios)を参照してください。

## 2.19.0

### Android

#### Weibo IdP

* Gamebase Android SDK 2.19.0でWeibo IdPログインと別のIdPログインを交互に呼び出すとクラッシュが発生します。
    * Weibo IdPを使用する場合は問題が修正されたGamebase Android SDK 2.19.1を使用してください。

## 2.18.2

### Android

#### Removed APIs

* Gamebase Android SDK 2.6.0でdeprecatedとなっていた以下の関数が削除されました。
    * **GamebaseConfiguration.Builder.setFCMSenderId()**
    * **GamebaseConfiguration.Builder.setTencentAccessKey()**
    * **GamebaseConfiguration.Builder.setTencentAccessId()**

## 2.18.0

### Android

#### Purchase Google

* Gamebase Android SDK 2.18.0でGoogleアイテム決済を呼び出すとクラッシュが発生します。
    * 問題が修正されたGamebase Android SDK 2.18.1を使用してください。

## 2.17.0

### Android

* Gamebase Android SDK 2.17.0でGamebase.ImageNotice.showImageNotices APIを呼び出すとクラッシュが発生します。
    * 2.17.0のクラッシュおよびOS 5.0～6.0でカスタムスキームイベントが動作しない問題が修正されたGamebase Android SDK 2.17.4を使用してください。

## 2.15.1

### iOS

* SDKで定義したタイプ **GamebaseEventCategory**をNSStringの代わりに使用する場合、該当タイプを **TCGBGamebaseEventCategory**に修正する必要があります。

## 2.15.0

### Android

#### Purchase Google

* **gamebase-adapter-purchase-google**を使用する場合、Gamebase SDK 2.15.0未満バージョンから2.15.以上にアップグレードする場合は、必ず**以前のバージョンのGame Client Versionをアップデート必須**に設定する必要があります。
	* Google Billing Clientモジュールがアップデートされ、複数の端末で別々のBilling Clientバージョンが適用された状態でアイテムを購入する場合、エラーが発生した時の再処理に問題が発生することがあるためです。

## 2.6.0

### Unity

#### Android Limitation

* Android Support Libraryバージョンが28.0.0に上がり、Unity 5、Unity 2017.1、Unity 2017.2ではAndroidのビルドが失敗します。
	* Unity 2017.3未満のバージョンのEditorを使用している場合はUnity 2017.3以上のバージョンをインストールし、「Editor/Data/PlaybackEngines/AndroidPlayer/Tools/gradle/lib」フォルダをコピーして使用中のUnity Editorの同じパスに上書きしてmainTemplate.gradleファイルを下記のように修正してください。

```groovy
// GENERATED BY UNITY. REMOVE THIS COMMENT TO PREVENT OVERWRITING WHEN EXPORTING AGAIN
buildscript {
	repositories {
		jcenter()
        // >>> For download Gradle Android Plugin
        maven {
            url 'https://maven.google.com'
        }
	}

	dependencies {
		//classpath 'com.android.tools.build:gradle:2.1.0'
        // >>> Update Gradle Android Plugin version
        classpath 'com.android.tools.build:gradle:2.3.0'
	}
}
```

#### Firebase Push

* Firebase Cloud Messagingを使用している場合Firebaseコンソールからgoogle-services.jsonファイルをダウンロードし、xmlリソースに変換してプロジェクトに追加しないとPushが正常に動作しません。
    * Gamebase 2.5.0 以前のバージョンではxmlリソースなしてPush動作に問題ありませんでしたが、Gamebase 2.6.0からは必ずxmlリソースが必要です。
* 下のガイドを参考にしてPush設定を行ってください。
    * [\[Game > Gamebase > Android SDK ご利用ガイド > Push > Settings > Firebase\]](./aos-push/#firebase)

#### Standalone

* Removed Japan Purchase
	* 日本決済がFadeOutしました。
	* GamebaseUnitySDK_IAPAdapterを使用している場合は、下記のフォルダを直接削除してください。
        * Asset/Toast/Common
        * Asset/Toast/Core
        * Asset/Toast/IAP
        * Asset/Toast/Standalone

### Android

#### Limitation

* minSdkVersionが15(IceCreamSandwichMR1, 4.0.3)から16(JellyBean, 4.1)に変更されました。
	* OS 4.1未満の端末では正常な動作を保障しないため、プロジェクトのminSdkVersionが15の場合、16に変更してください。

#### Removed APIs

* 削除された関数は次のとおりです。代替関数に変更してください。
    * **Gamebase.getAuthBanInfo()**を削除しました。**Gamebase.getBanInfo()**に変更してください。
    * **Gamebase.getLanguageCode()**を削除しました。**Gamebase.getDeviceLanguageCode()**に変更してください。
    * **new GamebaseConfiguration.Builder(void)**を削除しました。**GamebaseConfiguration.newBuilder()**に変更してください。
    * **new GamebaseConfiguration.Builder.setAppId()**を削除しました。**GamebaseConfiguration.newBuilder()**に変更してください。
    * **new GamebaseConfiguration.Builder.setAppVersion()**を削除しました。**GamebaseConfiguration.newBuilder()**に変更してください。

#### Changed/Deprecated APIs

* Gamebase.activeApp()は自動的に呼び出されるため、今後は呼び出す必要がありません。
* Gamebase.initialize()の引数に必要なGamebaseConfigurationの作成方法が変更されました。
    * **new GamebaseConfiguration.Builder(String, String)**の代わりに**GamebaseConfiguration.newBuilder()**を呼び出してください。
* LaunchingStatus.isPlayable()は今後、呼び出さないでください。
	* [\[Game > Gamebase > Android SDK使用ガイド > 初期化 > Launching Information\]](./aos-initialization/#launching-information)文書を参照してLaunching Status Codeに応じてゲームプレイが可能かどうかを直接決定してください。
* Purchase
    * Store Codeの変更ができないため、**GamebaseConfiguration.newBuilder()**でStore Codeを伝達する必要があります。
        * Gamebase.Purchase.getStoreCode() / Gamebase.Purchase.setStoreCode()は削除される予定です。今後は使用しないでください。
    * Gamebase.Purchase.requestRetryTransaction()は呼び出す必要がありません。
* Push
    * Gamebase Android SDK 2.6.0以上からは、プッシュメッセージを送信する時、Gamebaseコンソールの**プッシュ**タブのメニューから送信する必要があります。
        * Gamebase Android SDK 2.6.0未満の場合、Gamebaseコンソールの**プッシュ(旧)** タブからプッシュを送信する必要があります。
    * GamebaseConfiguration.Builder.setFCMSenderId()は呼び出す必要がありません。
    * GamebaseConfiguration.Builder.setTencentAccessKey(), GamebaseConfiguration.Builder.setTencentAccessId()を呼び出している場合、APIの呼び出しを削除し、build.gradleに次のように宣言する必要があります。

```groovy
android {
    defaultConfig {
        ...
        // >>> For Tencent Push Notification
        manifestPlaceholders = [
            XG_ACCESS_ID : "1234567890",
            XG_ACCESS_KEY : "ABCDEFGHIJKL",
        ]
    }
}
```

## 2.4.4

### Unity

* Setting Toolがアップデートされました。
    * フォルダ構造が変更され、以前のバージョンのSettingToolを完全に削除した後、再インストールする必要があります。

## 2.2.2

### Unity

* GamebaseUnitySDKSettingsクラスの**storeCodeAOS**の変数名が **storeCodeAndroid**に変更されました。
    * **storeCodeAOS**を参照してStore Codeを定義するコードやPrefabがある場合は変数の参照に失敗するため、**storeCodeAndroid**変数に変更してください。

## 2.2.0

### Unity

* GamebaseMainActivityのPackage Nameが変更されました。
    * AndroidManifest.xmlのMainActivity宣言を下記のように変更していない場合、クラッシュが発生します。
    * **com.toast.gamebase.activity.GamebaseMainActivity** -> **com.toast.android.gamebase.activity.GamebaseMainActivity**

```xml
<manifest>
    ...
    <application>
    ...
        <activity android:name="com.toast.android.gamebase.activity.GamebaseMainActivity"
            android:launchMode="singleTask"
            android:configChanges="keyboard|keyboardHidden|screenLayout|screenSize|orientation"
            android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    ...
    </application>
    ...
</manifest>
```

## 2.1.0

### Common

#### Removed APIs

* 使用していないTransferKey機能を削除しました。
	* Guestアカウント移行機能が必要な場合は、Gamebase SDK 2.2.1から追加された[\[Game > Gamebase > Unity SDK使用ガイド > 認証 > TransferAccount\]](./unity-authentication/#transferaccount)機能を利用してください。
