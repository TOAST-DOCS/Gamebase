## Game > Gamebase > Upgrade Guide

## 2.19.0

### Android

* 若在Gamebase Android SDK 2.19.0中交替使用Weibo IdP登录和其他IdP登录，则将发生崩溃。
    * 如果需要用Weibo IdP，请使用已解决上述问题的Gamebase Android SDK 2.19.1。


## 2.18.2

### Android

#### Removed APIs

* 已经从Gamebase Android SDK 2.6.0中删除被deprecated的函数。
    * **GamebaseConfiguration.Builder.setFCMSenderId()**
    * **GamebaseConfiguration.Builder.setTencentAccessKey()**
    * **GamebaseConfiguration.Builder.setTencentAccessId()**

## 2.18.0

### Android

* 如果在Gamebase Android SDK 2.18.0中调用Google道具支付，则将发生崩溃。 
    * 如果需要用Weibo IdP，请使用已解决上述问题的Gamebase Android SDK 2.18.1。

## 2.17.0

### Android

* 若在Gamebase Android SDK 2.17.0中调用Gamebase.ImageNotice.showImageNotices API，则将发生崩溃。
    * 请使用已解决在2.17.0中发生崩溃或Custom Scheme Event在OS 5.0~6.0中不正常启动等问题的Gamebase Android SDK 2.17.4。
 
## 2.15.1

### iOS

* 当使用gamebase SDK中定义的**gamebaseeventcategory**类型而不使用nsstring时，要将此类型更改为**tcgbgamebaseeventcategory**。

## 2.15.0

### Android

* 使用**gamebase-adapter-purchase-google**时，若要将Gamebase SDK 2.15.0以下版本升级到2.15.0以上版本，则必须将**以前版本的Game Client Version设置为“必须更新”**。 
	* 若不更新，当更新Google Billing Client模块儿，在不同的Billing Client版本被适用于多个终端机的情况下，进行道具购买出现错误时，“支付在处理”的过程中将出现问题。

## 2.6.0

### Unity

#### Android Limitation

* Android Support Library版本升至28.0.0，Unity 5、Unity 2017.1、Unity 2017.2中Android创建失败。
	* 若使用Unity 2017.3以下版本的Editor，请安装Unity 2017.3以上版本后，复制“Editor/Data/PlaybackEngines/AndroidPlayer/Tools/gradle/lib”文件夹，按照正在使用的Unity Editor的相同路径覆盖后，如下修改mainTemplate.gradle文件。

```groovy
// GENERATED BY UNITY. REMOVE THIS COMMENT TO PREVENT OVERWRITING WHEN EXPORTING AGAIN
buildscript {
	repositories {
		jcenter()
        // >>> For download Gradle Android Plugin
        maven {
            url 'https://maven.google.com'
        }
	}

	dependencies {
		//classpath 'com.android.tools.build:gradle:2.1.0'
        // >>> Update Gradle Android Plugin version
        classpath 'com.android.tools.build:gradle:2.3.0'
	}
}
```

#### Firebase推送

* 使用 Firebase Cloud Messaging 时，要将从 Firebase Console 中下载的 google-services.json 文件转换为 xml 资源，并添加到项目中才能成功收到推送。
    * 使用 Gamebase 2.5.0 以前的旧版本时，没有 xml 资源的情况下也可收到推送，但使用 Gamebase 2.6.0 以上版本时必须要有 xml 资源才能收到。
* 请参考以下实施指南。
    * [\[Game > Gamebase > Android SDK 使用指南 > push > Settings > Firebase\]](./aos-push/#firebase)

#### Standalone

* Removed Japan Purchase
	* 日本支付已FadeOut。
	* 若使用GamebaseUnitySDK_IAPAdapter，请直接删除如下文件夹。
        * Asset/Toast/Common
        * Asset/Toast/Core
        * Asset/Toast/IAP
        * Asset/Toast/Standalone

### Android

#### Limitation

* minSdkVersion由15(IceCreamSandwichMR1, 4.0.3)更改为16(JellyBean, 4.1)。
	* OS 4.1以下的终端机中无法保证正常运行，因此项目的minSdkVersion为15时，请更改为16。

#### Removed APIs

* 清除的函数如下。请更改为替代函数。
    * **Gamebase.getAuthBanInfo()**已清除。请更改为**Gamebase.getBanInfo()**。
    * **Gamebase.getLanguageCode()**已清除。请更改为**Gamebase.getDeviceLanguageCode()**。
    * **new GamebaseConfiguration.Builder(void)**已清除。请更改为**GamebaseConfiguration.newBuilder()**。
    * **new GamebaseConfiguration.Builder.setAppId()**已清除。请更改为**GamebaseConfiguration.newBuilder()**。
    * **new GamebaseConfiguration.Builder.setAppVersion()**已清除。请更改为**GamebaseConfiguration.newBuilder()**。

#### Changed/Deprecated APIs

* Gamebase.activeApp()为自动调用，因此可不再调用。
* 作为Gamebase.initialize()的因素需要的GamebaseConfiguration的创建方法已更改。
    * 取代**new GamebaseConfiguration.Builder(String, String)**，调用**GamebaseConfiguration.newBuilder()**。
* 请勿再调用LaunchingStatus.isPlayable()。
	* 请参考[\[Game > Gamebase > Android SDK使用指南 > 初始化 > Launching Information\]](./aos-initialization/#launching-information)文件，按照Launching Status Code直接决定是否可以玩游戏。
* Purchase
    * Store Code无法更改，因此应从**GamebaseConfiguration.newBuilder()**传输Store Code。
        * Gamebase.Purchase.getStoreCode() / Gamebase.Purchase.setStoreCode()将清除。请勿再使用。
    * Gamebase.Purchase.requestRetryTransaction()现在不调用也无妨。
* Push
    * 自Gamebase Android SDK 2.6.0以上起，发送推送信息时，应通过Gamebase控制台的**推送**选项卡的菜单发送。
        * 若低于Gamebase Android SDK 2.6.0，应从Gamebase控制台的**推送（旧）**选项卡发送推送。
    * GamebaseConfiguration.Builder.setFCMSenderId()现在不调用也无妨。
    * 调用GamebaseConfiguration.Builder.setTencentAccessKey(), GamebaseConfiguration.Builder.setTencentAccessId()时，应清除API调用，并在build.gradle中如下声明。

```groovy
android {
    defaultConfig {
        ...
        // >>> For Tencent Push Notification
        manifestPlaceholders = [
            XG_ACCESS_ID : "1234567890",
            XG_ACCESS_KEY : "ABCDEFGHIJKL",
        ]
    }
}
```

## 2.4.4

### Unity

* Setting Tool已升级。
    * 文件夹结构更改，应将之前版本的SettingTool完全删除后重新安装。

## 2.2.2

### Unity

* GamebaseUnitySDKSettings类的**storeCodeAOS**变量名更改为**storeCodeAndroid**。
    * 若存在参考**storeCodeAOS**定义Store Code的代码或Prefab，则变量参考失败，因此请更改为**storeCodeAndroid**变量。

## 2.2.0

### Unity

* GamebaseMainActivity的Package Name已更改。
    * AndroidManifest.xml的MainActivity声明若未如下更改，则会发生崩溃。
    * **com.toast.gamebase.activity.GamebaseMainActivity** -> **com.toast.android.gamebase.activity.GamebaseMainActivity**

```xml
<manifest>
    ...
    <application>
    ...
        <activity android:name="com.toast.android.gamebase.activity.GamebaseMainActivity"
            android:launchMode="singleTask"
            android:configChanges="keyboard|keyboardHidden|screenLayout|screenSize|orientation"
            android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    ...
    </application>
    ...
</manifest>
```

## 2.1.0

### Common

#### Removed APIs

* 未使用的TransferKey功能已清除。
	* 若需要Guest账号迁移功能，请使用自Gamebase SDK 2.2.1起添加的[\[Game > Gamebase > Unity SDK使用指南 > 验证 > TransferAccount\]](./unity-authentication/#transferaccount)功能。
